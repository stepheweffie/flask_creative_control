<!DOCTYPE html>
<html>
  <head>
  <link href="static/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="static/css/application.css" rel="stylesheet" media="screen">

  </head>
<body>
<div id="chat-log">
<ul>

{{ welcome_message }}

</ul>

<br>
<br>

</div>

<form method="POST" id="chat" class="form-inline" action="/">
    <input type="text" id="handle" class="text-input"><br>
    <input type="text" id="chat-text" class="text-input"><br>
    <button type="submit" id="send">Send</button>
</form>

    <!--<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>-->
     <script type="text/javascript" src="{{ url_for('static', filename='jquery-2.0.3.min.js') }}"></script>
<script>
if ("WebSocket in window") {
    alert("WebSocket is supported by your Browser!");
    const client = new WebSocket('wss://cc-simple-chat.herokuapp.com:5000');
    client.onmessage = function(message) {
        const message_data = JSON.parse(message.data);
    $("#chat-log").slideUp(2000).html().css("").stop().animate({
    scrollTop: $('#chat-log')[0].scrollHeight
  }, 800);
};

$("button").click = function(event) {
  event.preventDefault();
  const handle = $("#handle")[0].value;
  const text = $("#chat-text")[0].value;
  client.send(JSON.stringify({ handle: handle, text: text }));
  $.post("chat.asp"),
      {
          handle: handle,
          text: text,
      },
      function(data,status){
      $('#chat-log').append(data)
          const code = status
      };
  $(".text-input")[0].value = "";
};}
</script>
</body>
</html>
